const https = require('https');
//引入db.js中增的写法
// const { insert } = require('./db');
https.get('https://activity.m.duiba.com.cn/chw/visual-editor/items/list?appItemIds=1900426,1844378,1844379,1900434,1844380,1888501,1202686,1202677,1202682,1888510,1900412,1900411,2152876,2087844,2000789,684271,2081161,2018812,2183089,2018810,1161758,1533566,1982298,1990013,1982301,1990012,2153913,2157305,2000802,1029043,2059672,2157306,2033149,2111343,1966537,2082751,1990037,2084759,2084762,2049624,2084766,1136135,2084769,2082750,2090325,2136106,2093374,2099479,2117729,2117730,2117731,2122345,2136164,2136472,2136475,2147088,1894301,1992476,1992479,2000803,2002773,1990023,2009316,1362306,2009472,2014172,2018799,2018807,1990028,2078714,2078718,2080287,1990015,1990016,1990017,1990022,1990026,1355960,1990027,1990033,1990035,1990040,1990041,1312305,1142165,818249,722533,1176189,1847582,1851845,1879795,1888679,1894289,1932733,1942117,1841592,1841591,1841590,1841586,1841585,1828876,1819359,1990042,1819203,1819158,1807483,1693379,1476257,1450682,1437369,1390042,1357222,1357218,1357216,1841942,1841922,1841918,1841915,1841594,1841593&pageNo=1&pageSize=50&sort=custom&soldOutType=sink&showFlowRules=true', (res) => {
    res.setEncoding('utf8');
    let rawData = '';
    res.on('data', (chunk) => { rawData += chunk; });
    res.on('end', () => {
        //拿数据
        let more = JSON.parse(rawData).list;
        console.log(more);
        more.forEach(element => {  //每个遍历的对象：element
            //插入到数据库中
             insert('more',[{
                nm:element.nm,
                sc:element.sc,
                star:element.star,
                showInfo:element.showInfo,
                img:element.img,
             }])
        })
    });
}).on('error', (e) => {
    console.error(`出现错误: ${e.message}`);
});